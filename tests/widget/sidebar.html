<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>zoneerder met sidebar</title>

  <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="../../resources/pyoes-compiled-app.css">
  <link rel="stylesheet" href="../../resources/zoneerder.css" />
  <link rel="stylesheet" href="../../ol/ol.css" />
  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #widgetNode {
      width: 800px;
      height: 600px;
    }
  </style>
  <script src="../../proj4/dist/proj4.js" type="text/javascript"></script>
</head>

<body>
<div id="widgetNode"></div>
<div id="setZoneNode"></div>
<div id="getZoneNode"></div>
<div id="resetZoneNode"></div>
<div id="button1Node"></div>
<div id="button2Node"></div>
<div id="button3Node"></div>


<!-- load Dojo -->
<script type="text/javascript" src="../config.js"></script>
<script type="text/javascript" src="../../dojo/dojo.js"></script>
<script>
  require([
    "zoneerder/ZoneMap",
    'dojo/_base/lang',
    'dojo-form-controls/Button',
    'dojo/json',
    "dojo/domReady!"
  ], function (ZoneMap, lang, Button, JSON) {

    var zoneMapConfig = {
      buttons: {
        fullScreen: true,
        zoomInOut: true,
        zoomFullExtent: true,
        zoomGeolocation: true,
        rotate: true
      },
      sidebar: {
        layers: true,
        zoom: true,
        draw: true,
        help: true
      },
      erfgoedUrl: 'https://dev-geo.onroerenderfgoed.be/zoekdiensten/afbakeningen',
      niscodeUrl: 'https://dev-geo.onroerenderfgoed.be/zoekdiensten/administratievegrenzen',
      perceelUrl: 'https://dev-geo.onroerenderfgoed.be/ogcproxy?url=https://geo.agiv.be/ogc/wfs/grb',
      beschermingUrl: 'https://dev-geo.onroerenderfgoed.be/geoserver/wms',
      crabpyUrl: 'https://dev-geo.onroerenderfgoed.be',
      mapproxyUrl: 'https://dev-geo.onroerenderfgoed.be/mapproxy/service'
    };

    // init widget
    var widgetUnderTest = new ZoneMap({
      config: zoneMapConfig
    }, 'widgetNode');
    widgetUnderTest.startup();

    widgetUnderTest.on("zonechanged", function(event){
      console.log("zone changed event: ", event.zone);
    });

    var myButton = new Button({
      label: "get features",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.getFeaturesInZone().then(function (features) {
          console.log(features);
        });
      })
    }, 'button1Node');
    myButton.startup();

    var getZoneButton = new Button({
      label: "get zone",
      onClick: lang.hitch(this, function () {
        console.log(JSON.stringify(widgetUnderTest.getZone()));
      })
    }, 'getZoneNode');
    getZoneButton.startup();

    var testzone = {"type":"MultiPolygon","coordinates":[[[[123796.3989870126,161922.68658473343],[125855.60320366417,162033.58173123002],[126451.84609249674,157270.33629081864],[126158.4321447326,156715.58044047095],[125322.48775104273,156816.1542271264],[123796.3989870126,161922.68658473343]]]],"crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::31370"}}};

    var setZoneButton = new Button({
      label: "set zone",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.setZone(testzone);
      })
    }, 'setZoneNode');
    setZoneButton.startup();

    new Button({
      label: "reset zoneerder",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.resetZone();
      })
    }, 'resetZoneNode').startup();

    var myButtonNis = new Button({
      label: "get niscodes",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.getNiscodesInZone().then(function (niscodes) {
          console.log(niscodes);
        });
      })
    }, 'button3Node');
    myButtonNis.startup();

    var myButton2 = new Button({
      label: "set features",
      onClick: lang.hitch(this, function () {
        var testfeature1 = {"id":"dibe_relict.39615","uri":"https://inventaris.onroerenderfgoed.be/dibe/relict/39615","naam":"Dorpswoning van 1827","geometrie":{"type":"MultiPoint","coordinates":[[4.02877235726,50.724927926483]],"crs":{"type":"name","properties":{"name":"EPSG:4326"}}},"description":"Op de deuromlijsting gedateerd 1827, voorheen een geheel uitmakend met nr. 6 en 7. ","type":"dibe_relict"};
        var testfeature2 = {"id":"dibe_relict.39611","uri":"https://inventaris.onroerenderfgoed.be/dibe/relict/39611","naam":"Parochiekerk Sint-Pieter","geometrie":{"type":"MultiPoint","coordinates":[[4.0293166750887,50.725166486489]],"crs":{"type":"name","properties":{"name":"EPSG:4326"}}},"description":"Belangwekkend gebouw met omringend kerkhof, hoofdzakelijk opgetrokken uit breuksteen van schilfersteen met gebruik van Doornikse kalksteen en zandsteen.","type":"dibe_relict"};
        var testfeature3 = {"categorie": "objecten", "naam": "Congoberg", "uri": "https://id.erfgoed.net/beschermingen/OB000260", "geometrie": {"crs": {"type": "name", "properties": {"name": "EPSG:31370"}}, "type": "MultiPolygon", "coordinates": [[[[124467.252750002, 162780.2685], [124466.197375, 162772.821875002], [124465.400750004, 162767.195875], [124463.900624998, 162762.349874999], [124467.4855, 162750.335000001], [124472.131625004, 162734.764375001], [124475.6325, 162723.032375], [124476.791874997, 162719.036499999], [124478.949875005, 162712.276250001], [124480.65975, 162706.917750001], [124482.850625001, 162702.792874999], [124485.792125002, 162699.976], [124488.909500003, 162696.992000002], [124497.024750002, 162689.727875002], [124501.862000003, 162685.39875], [124509.187124997, 162678.744375002], [124514.692000002, 162673.530250002], [124521.858750001, 162668.040750001], [124526.809749998, 162664.248], [124536.690750003, 162657.163249999], [124545.150125004, 162651.097875003], [124560.024499997, 162640.603750002], [124574.050125003, 162629.724125002], [124586.474750005, 162620.918375], [124600.732875004, 162610.8145], [124611.118749999, 162603.45425], [124631.386624999, 162588.34925], [124635.182499997, 162585.490875002], [124646.066624999, 162576.9965], [124657.397500001, 162567.30675], [124676.698375002, 162549.422000002], [124694.605125003, 162532.243000001], [124730.74825, 162497.695], [124738.603500001, 162495.239875], [124743.033250004, 162494.286000002], [124763.802625, 162490.914000001], [124777.929625005, 162488.67075], [124780.805500001, 162488.205250002], [124792.9745, 162486.236250002], [124805.810125001, 162484.123], [124814.799500003, 162482.613000002], [124820.763125002, 162481.005625002], [124824.854249999, 162479.905375], [124831.505249999, 162474.225749999], [124866.879249997, 162449.0955], [124903.660625003, 162422.552375], [124922.926375002, 162408.549875002], [124945.257375002, 162392.631875001], [124951.461500004, 162387.500750002], [124959.447750002, 162381.026750002], [124964.452250004, 162378.776875], [124972.214500003, 162375.248625003], [124979.548375003, 162371.877750002], [124986.516500004, 162367.637250002], [125000.044749998, 162358.082875002], [124999.337625004, 162350.861375], [124998.455875002, 162341.869875003], [124997.685625002, 162334.002750002], [124996.432374999, 162321.218499999], [124995.262125, 162309.27575], [124994.372625001, 162300.202125002], [124992.269249998, 162289.484250002], [124990.703500003, 162281.506625], [124988.431874998, 162269.933125], [124986.250875004, 162258.820750002], [124983.289625004, 162244.321000002], [124980.481624998, 162230.574124999], [124978.772624999, 162222.20975], [124978.130249999, 162214.861625001], [124978.415375002, 162206.192375001], [124978.90275, 162191.399875], [124980.154875003, 162179.437375002], [124981.409249999, 162167.443125002], [124983.286499999, 162149.504875001], [124985.167000003, 162133.874375001], [124987.024499997, 162118.436000001], [124988.571625002, 162105.030125], [124981.035499997, 162096.24825], [124974.520000003, 162088.657625001], [124968.138875, 162075.548875], [124961.447250001, 162061.79975], [124955.569875002, 162049.725875001], [124950.791625001, 162039.4395], [124945.557875, 162028.170875002], [124938.203000002, 162012.337000001], [124931.979125001, 161999.451125], [124929.529375002, 161994.809500001], [124918.315375, 161994.293749999], [124912.280625001, 161993.951750003], [124900.137874998, 161993.263374999], [124892.532875001, 161992.876625001], [124883.379625, 161992.103], [124868.813249998, 161991.32925], [124853.730000004, 161990.427875001], [124844.868500002, 161989.864125002], [124830.819125004, 161988.969250001], [124811.18925, 161987.720375001], [124803.675000004, 161987.27775], [124793.657499999, 161986.688750003], [124782.801875003, 161985.343625002], [124763.493249997, 161982.949625], [124747.119625002, 161981.01675], [124737.427749999, 161978.8915], [124723.619750001, 161975.86375], [124708.318000004, 161972.508125], [124695.295625001, 161969.317625001], [124682.535374999, 161966.191375002], [124675.680124998, 161964.648625001], [124661.484125003, 161961.454750001], [124644.503125004, 161957.632625002], [124632.13075, 161954.848500002], [124619.884125002, 161950.335750002], [124620.841250002, 161948.073875003], [124626.974375002, 161933.577625003], [124633.516249999, 161917.621375002], [124639.350000001, 161903.411250003], [124642.960124999, 161900.704750001], [124645.408875003, 161895.677250002], [124653.24425, 161877.987], [124659.544624999, 161863.763875], [124665.100874998, 161851.219000001], [124670.541375004, 161838.9395], [124678.089375004, 161821.89725], [124683.438000001, 161809.822125003], [124687.962750003, 161800.118125003], [124694.137375005, 161786.876125], [124702.517000005, 161768.828625001], [124707.415375002, 161756.838750001], [124711.541375004, 161746.784000002], [124715.776500002, 161737.16525], [124720.371124998, 161726.730374999], [124725.334125005, 161715.4595], [124720.048875004, 161713.912250001], [124724.094000004, 161703.971124999], [124728.859125003, 161692.257625002], [124733.595750004, 161680.614250001], [124736.341624998, 161673.867125001], [124741.447625004, 161661.315625001], [124747.013750002, 161648.792625003], [124752.246375002, 161637.017999999], [124756.762500003, 161626.857375], [124760.079875, 161619.741750002], [124762.387500003, 161615.045500003], [124766.131999999, 161607.424125001], [124770.558499999, 161598.416250002], [124776.435874999, 161587.562875003], [124783.34375, 161575.84725], [124785.277874999, 161576.234000001], [124789.386250004, 161569.093499999], [124794.612500004, 161560.009], [124801.779250003, 161548.00175], [124795.978375003, 161548.00175], [124792.110250004, 161547.616125003], [124785.694125004, 161547.585500002], [124774.300875001, 161547.531874999], [124764.522624999, 161547.486000001], [124762.691250004, 161539.745500002], [124760.526749998, 161530.598875001], [124759.238499999, 161525.701500002], [124747.650750004, 161527.041125], [124737.933624998, 161528.1655], [124728.040624999, 161529.309374999], [124727.635250002, 161525.451250002], [124727.010250002, 161519.512625001], [124716.811375, 161521.505625002], [124708.216499999, 161523.186125003], [124698.649000004, 161525.055750001], [124689.341624998, 161526.9045], [124681.117125005, 161528.536875002], [124679.881375, 161521.658624999], [124678.050125003, 161511.461875003], [124675.606875002, 161497.862500001], [124673.383375004, 161485.480500001], [124670.675750002, 161487.672375001], [124665.659249999, 161490.36025], [124658.914250001, 161493.974874999], [124650.950874999, 161498.24275], [124645.380374998, 161501.340375002], [124633.712875001, 161507.826625001], [124621.811625004, 161514.443750001], [124615.243500002, 161518.095375001], [124607.325000003, 161520.720125001], [124600.577875003, 161522.956625], [124592.296499997, 161525.701500002], [124581.538125001, 161528.915125001], [124572.445, 161531.631375], [124563.6545, 161532.72075], [124555.550125003, 161533.724874999], [124546.941, 161534.7925], [124541.24825, 161535.498375002], [124536.606624998, 161537.560125001], [124529.775250003, 161542.329750001], [124524.614500001, 161547.280500002], [124521.055624999, 161550.694000002], [124517.14175, 161554.4485], [124508.763125002, 161558.186500002], [124501.184500001, 161558.134], [124489.940875001, 161558.057500001], [124478.210000001, 161558.186500002], [124470.990874998, 161560.378375001], [124463.772624999, 161563.600625001], [124458.708125003, 161566.9485], [124456.166625001, 161568.628000002], [124449.764624998, 161575.278999999], [124446.239749998, 161578.940625001], [124442.372749999, 161584.098000001], [124439.031500004, 161591.304125], [124434.818000004, 161599.852125], [124431.083374999, 161607.320374999], [124425.872500002, 161617.744375002], [124419.555749997, 161629.989875], [124417.556249999, 161632.25725], [124414.046499997, 161636.234625001], [124409.886749998, 161640.948249999], [124407.338624999, 161643.31825], [124404.343625002, 161646.103625], [124398.800625004, 161648.940000001], [124393.762249999, 161650.199999999], [124390.709375001, 161650.962500002], [124380.238250002, 161653.580625001], [124368.792625003, 161656.6085], [124358.0145, 161659.459125001], [124343.486500002, 161663.302124999], [124325.048749998, 161667.723000001], [124303.506875001, 161672.776625], [124298.507875003, 161673.949124999], [124294.361249998, 161675.206625], [124289.347000003, 161676.728750002], [124285.874499999, 161665.441500001], [124283.598499998, 161657.993875001], [124281.108374998, 161649.849125002], [124277.021750003, 161636.478250001], [124272.629124999, 161622.103125002], [124269.759875, 161612.716000002], [124268.223625004, 161607.3695], [124266.536499999, 161601.500750002], [124264.078000002, 161595.475875001], [124261.723375, 161589.706625], [124259.438625, 161584.109999999], [124253.646250002, 161569.917375002], [124250.620625004, 161563.021500003], [124248.103124999, 161557.283875], [124246.039125003, 161551.290750001], [124244.108500004, 161545.682], [124242.131750003, 161539.0975], [124239.981375001, 161531.373500001], [124227.484625004, 161537.247625001], [124216.050875001, 161542.622500002], [124201.966499999, 161549.243000001], [124185.837625004, 161556.823875003], [124174.588624999, 161562.112375002], [124166.760750003, 161565.791375], [124153.868375003, 161529.955250002], [124152.580125004, 161526.087125], [124126.667625003, 161538.721750002], [124118.589500003, 161545.082125001], [124111.522124998, 161550.646000002], [124103.407875001, 161557.034875002], [124093.730125003, 161564.653999999], [124084.107000001, 161572.230500001], [124075.74825, 161578.811750002], [124075.578874998, 161571.654625002], [124075.414875001, 161564.695500001], [124075.167999998, 161554.235375002], [124075.232375003, 161542.975375], [124071.144749999, 161545.618625], [124066.130500004, 161548.859500002], [124055.065125003, 161556.013250001], [124044.092500001, 161563.105750002], [124035.679125004, 161568.545000002], [124024.184124999, 161575.97625], [124032.304750003, 161588.3255], [124038.283875003, 161597.417625003], [124045.969750002, 161609.105875], [124020.462625004, 161628.289750002], [124010.334624998, 161621.327375002], [124001.789875001, 161619.42825], [123992.928374998, 161619.745124999], [123985.333250001, 161622.909500003], [123980.270000003, 161628.922499999], [123977.738125004, 161636.201750003], [123976.788625002, 161645.379125003], [123978.055, 161654.240625001], [123977.904250003, 161662.734000001], [123966.252000004, 161672.752625], [123956.829999998, 161680.852375001], [123945.040124997, 161690.989250001], [123946.578625001, 161694.57525], [123950.574500002, 161698.958000001], [123960.799625002, 161705.333750002], [123970.504749998, 161711.384875], [123990.150750004, 161722.9355], [123992.67825, 161724.478250001], [124002.178999998, 161730.278124999], [124010.386, 161735.289124999], [124017.094999999, 161739.386624999], [124029.211500004, 161746.784000002], [124034.386500001, 161750.853], [124041.848125003, 161756.719500002], [124048.289499998, 161761.784125], [124055.248750001, 161767.255000003], [124062.985875003, 161773.339000002], [124069.689374998, 161778.238500003], [124077.069250003, 161785.6195], [124082.291125, 161790.841499999], [124090.960249998, 161799.509625003], [124097.143750004, 161802.807125002], [124110.934250005, 161810.312750001], [124117.773249999, 161814.204750001], [124122.195250005, 161816.285250001], [124127.02375, 161819.148000002], [124133.114250004, 161823.358000003], [124137.03475, 161826.436125003], [124143.326375, 161831.373750001], [124147.35825, 161834.930500001], [124152.059, 161839.436625], [124160.700874999, 161847.72225], [124167.253624998, 161854.99625], [124175.912875004, 161864.609500002], [124181.998000003, 161871.132625002], [124187.806500003, 161877.357625], [124195.635499999, 161885.751499999], [124196.023500003, 161887.4265], [124197.682125002, 161889.060125001], [124202.959624998, 161894.253625002], [124208.863499999, 161900.062125001], [124214.594374999, 161905.702625003], [124221.291375004, 161912.291250002], [124228.249499999, 161919.139000002], [124234.2755, 161924.095375001], [124238.215750001, 161927.33625], [124244.236375004, 161932.288125001], [124249.908375002, 161935.896125], [124283.553750001, 162015.177875001], [124303.706875004, 162063.126250003], [124318.079750001, 162099.114250001], [124313.800999999, 162101.592500001], [124308.026124999, 162104.937249999], [124309.719750002, 162108.065500002], [124284.151375003, 162122.561875001], [124282.006499998, 162120.241], [124275.432000004, 162122.947500002], [124265.963875003, 162126.423374999], [124257.967875004, 162129.359375], [124251.142999999, 162132.141249999], [124245.432750002, 162134.642375], [124234.129124999, 162139.592125002], [124221.529624999, 162145.109000001], [124213.425250001, 162148.495250002], [124207.428750001, 162150.676125001], [124199.373625003, 162153.605625], [124189.341875002, 162157.261624999], [124180.32175, 162160.559374999], [124171.28875, 162163.932375003], [124158.658624999, 162168.7555], [124154.383000001, 162170.387875002], [124144.841875002, 162176.894750003], [124136.734250002, 162182.310000002], [124129.715000004, 162186.971250001], [124115.018624999, 162196.729875002], [124110.039375, 162200.037374999], [124105.003250003, 162210.147875], [124099.133375004, 162221.930125002], [124092.765375003, 162234.715375002], [124090.056625001, 162240.516249999], [124092.933624998, 162246.377374999], [124096.890124999, 162254.438000001], [124103.622125, 162262.452750001], [124108.783875003, 162268.597875003], [124115.840374999, 162276.99825], [124126.889375001, 162290.657625001], [124133.571000002, 162298.918375], [124142.306874998, 162309.718125001], [124156.737750001, 162327.558125], [124162.763750002, 162335.008000001], [124168.344000004, 162342.262125], [124174.131875001, 162349.787374999], [124182.099624999, 162360.145874999], [124193.701499999, 162376.775125001], [124195.432250001, 162379.987500001], [124197.311750002, 162383.478625], [124200.301375002, 162390.832375001], [124203.3345, 162398.293000001], [124208.526875004, 162411.06625], [124209.559375003, 162414.029625002], [124210.429125004, 162418.585999999], [124212.071500003, 162427.179875001], [124214.437124997, 162439.554250002], [124217.057250001, 162453.266125001], [124220.072000004, 162469.04425], [124222.825500004, 162483.453375001], [124225.654375002, 162498.256750003], [124227.541375004, 162508.130125001], [124228.379500002, 162512.519250002], [124229.625124998, 162514.458875], [124235.071000002, 162522.938875001], [124241.040250003, 162532.234375], [124244.108500004, 162537.012625001], [124245.008874997, 162538.815375], [124252.363499999, 162543.469000001], [124266.52775, 162553.545625001], [124280.718249999, 162565.114875], [124291.069125004, 162583.71525], [124310.306500003, 162618.283875], [124330.864, 162655.224750001], [124345.431500003, 162680.490499999], [124365.466624998, 162698.010375001], [124379.317249998, 162710.1215], [124401.894874997, 162729.863875002], [124398.026875004, 162745.075874999], [124395.320375003, 162756.291000001], [124403.827875003, 162758.225125], [124429.611625001, 162765.057500001], [124435.669375002, 162767.249375001], [124467.252750002, 162780.2685]], [[124447.272250004, 162726.383625001], [124445.863875002, 162731.513625], [124438.994374998, 162729.526125003], [124440.438749999, 162723.806125], [124443.146375, 162714.910625], [124453.202250004, 162717.747250002], [124450.752499998, 162727.157250002], [124447.272250004, 162726.383625001]], [[124368.636375003, 162026.13625], [124364.768375002, 162023.17075], [124367.218125001, 162019.6895], [124362.706375003, 162016.209249999], [124364.897375003, 162012.600375], [124373.791625001, 162019.173750002], [124368.636375003, 162026.13625]], [[124267.053374998, 161942.343000002], [124277.366000004, 161938.990625001], [124274.013625003, 161945.824124999], [124267.053374998, 161942.343000002]]]]}, "type": "erfgoedobjecten", "id": "OB000260"};
        widgetUnderTest.setFeatures([testfeature2, testfeature1, testfeature3]);
        widgetUnderTest.mapController.zoomToFeatures();

      })
    }, 'button2Node');
    myButton2.startup();

  });

</script>
</body>

</html>