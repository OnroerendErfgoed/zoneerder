<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>zoneerder met sidebar</title>

  <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="../../resources/zonemap.css" />
  <link rel="stylesheet" href="../../ol/ol.css" />
  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #widgetNode {
      width: 800px;
      height: 600px;
    }
  </style>
  <script src="../../proj4/dist/proj4.js" type="text/javascript"></script>
</head>

<body>
<div id="widgetNode"></div>
<div id="button1Node"></div>
<div id="button2Node"></div>
<div id="button3Node"></div>


<!-- load Dojo -->
<script type="text/javascript" src="../config.js"></script>
<script type="text/javascript" src="../../dojo/dojo.js"></script>
<script>
  require([
    "zoneerder/ZoneMap",
    'dojo/_base/lang',
    'dojo-form-controls/Button',
    "dojo/domReady!"
  ], function (ZoneMap, lang, Button) {

    var zoneMapConfig = {
      buttons: {
        fullScreen: true,
        zoomInOut: true,
        zoomFullExtent: true,
        zoomGeolocation: true,
        rotate: true
      },
      sidebar: {
        layers: true,
        zoom: true,
        draw: true,
        help: true
      },
      erfgoedUrl: 'https://dev-geo.onroerenderfgoed.be/zoekdiensten/afbakeningen',
      niscodeUrl: 'https://dev-geo.onroerenderfgoed.be/zoekdiensten/administratievegrenzen',
      perceelUrl: 'https://dev-geo.onroerenderfgoed.be/ogcproxy?url=https://geo.agiv.be/ogc/wfs/grb',
      crabpyUrl: 'https://dev-geo.onroerenderfgoed.be'
    };

    // init widget
    var widgetUnderTest = new ZoneMap({
      config: zoneMapConfig
    }, 'widgetNode');
    widgetUnderTest.startup();

    widgetUnderTest.on("zonechanged", function(event){
      console.log("zone changed event: ");
      console.log(event);
    });

    var myButton = new Button({
      label: "get features",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.getFeaturesInZone().then(function (features) {
          console.log(features);
        });
      })
    }, 'button1Node');
    myButton.startup();

    var myButtonNis = new Button({
      label: "get niscodes",
      onClick: lang.hitch(this, function () {
        widgetUnderTest.getNiscodesInZone().then(function (niscodes) {
          console.log(niscodes);
        });
      })
    }, 'button3Node');
    myButtonNis.startup();

    var myButton2 = new Button({
      label: "set features",
      onClick: lang.hitch(this, function () {
        var testfeature1 = {"id":"dibe_relict.39615","uri":"https://inventaris.onroerenderfgoed.be/dibe/relict/39615","naam":"Dorpswoning van 1827","geometrie":{"type":"MultiPoint","coordinates":[[4.02877235726,50.724927926483]],"crs":{"type":"name","properties":{"name":"EPSG:4326"}}},"description":"Op de deuromlijsting gedateerd 1827, voorheen een geheel uitmakend met nr. 6 en 7. ","type":"dibe_relict"};
        var testfeature2 = {"id":"dibe_relict.39611","uri":"https://inventaris.onroerenderfgoed.be/dibe/relict/39611","naam":"Parochiekerk Sint-Pieter","geometrie":{"type":"MultiPoint","coordinates":[[4.0293166750887,50.725166486489]],"crs":{"type":"name","properties":{"name":"EPSG:4326"}}},"description":"Belangwekkend gebouw met omringend kerkhof, hoofdzakelijk opgetrokken uit breuksteen van schilfersteen met gebruik van Doornikse kalksteen en zandsteen.","type":"dibe_relict"};
        widgetUnderTest.setFeatures([testfeature2, testfeature1]);
        widgetUnderTest.mapController.zoomToFeatures();

      })
    }, 'button2Node');
    myButton2.startup();

  });

</script>
</body>

</html>